<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>Ordinals.epsilon0.Goodstein</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Ordinals.epsilon0.Goodstein</h1>

<code>
<span class="keyword">Require</span> <span class="keyword">Import</span> <a class="modref" href="Ordinals.prelude.More_nat.html">More_nat</a>.<br/>
<span class="keyword">Require</span> <span class="keyword">Import</span> Arith.<br/>
<span class="keyword">Require</span> <span class="keyword">Import</span> ArithRing.<br/>
<span class="keyword">Require</span> <span class="keyword">Import</span> <a class="modref" href="Ordinals.epsilon0.EPSILON0.html">EPSILON0</a>.<br/>

<br/>
<span class="keyword">Inductive</span> <a name="correct"></a>correct (N:nat) : T1 -&gt; Prop :=<br/>
&nbsp;&nbsp;&nbsp;<a name="Zero_correct"></a>Zero_correct : correct N zero<br/>
&nbsp;| <a name="Cons_correct"></a>Cons_correct : forall (c c' : T1 )(p:nat), (S p &lt; N)%nat -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;correct N c -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;correct N c' -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;correct N (cons c p c').<br/>

<br/>
<span class="keyword">Lemma</span> <a name="correct_succ"></a>correct_succ : forall  N c, correct N c -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;correct (S N) c.<br/>

<br/>
<span class="keyword">Fixpoint</span> <a name="val"></a>val (N:nat)(c:T1) {struct c}: nat :=<br/>
&nbsp;&nbsp;match c with <br/>
&nbsp;&nbsp;| zero =&gt; 0<br/>
&nbsp;&nbsp;| cons alpha n beta =&gt; ((power N (val N alpha) * (S n)) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val N beta)%nat<br/>
&nbsp;&nbsp;end.<br/>

<br/>
<span class="keyword">Section</span> predecessor.<br/>
&nbsp;<span class="keyword">Variable</span> N0:nat.<br/>
&nbsp;<span class="keyword">Let</span> N := S (S N0).<br/>

<br/>
&nbsp;<span class="keyword">Definition</span> <a name="pred_spec"></a>pred_spec (c:T1) := {c':T1 | <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nf c'                             /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(c = zero /\ c'= zero \/ c' &lt; c) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val N c' =  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Peano.pred (val N c) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;correct N c'}.<br/>

<br/>
&nbsp;<span class="keyword">Variable</span> c : T1.<br/>
&nbsp;<span class="keyword">Hypothesis</span> nf_c : nf c.<br/>
&nbsp;<span class="keyword">Hypothesis</span> coeff_ok : correct N c.<br/>

<br/>

<br/>
&nbsp;<span class="keyword">Variable</span> recurr : forall c', correct N c' -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nf c' -&gt; c' &lt; c -&gt; pred_spec c'.<br/>

<br/>
&nbsp;<span class="keyword">Definition</span> <a name="pred_n_zero"></a>pred_n_zero : pred_spec zero.<br/>

<br/>
&nbsp;<span class="keyword">Definition</span> <a name="PredF"></a>PredF : forall n , (n &lt; N)%nat -&gt; pred_spec (F (S n)).<br/>

<br/>
&nbsp;<span class="keyword">Lemma</span> <a name="val_positive"></a>val_positive:  forall a, zero &lt; a -&gt; nf a -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;forall N, <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(0 &lt; val (S (S N)) a)%nat.<br/>

<br/>
<span class="keyword">Definition</span> <a name="Pred_omega_a"></a>Pred_omega_a : forall a, zero &lt; a -&gt; c = cons a 0 zero -&gt; pred_spec c.<br/>

<br/>

<br/>

<br/>
<span class="keyword">Definition</span> <a name="Pred_omega_an"></a>Pred_omega_an : forall a k, (S k &lt; N)%nat -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;lt zero a -&gt; c = cons a (S k) zero <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; pred_spec c.<br/>

<br/>

<br/>

<br/>

<br/>
<span class="keyword">Definition</span> <a name="Pred_omega_anb"></a>Pred_omega_anb : forall a k b,  ((S k) &lt; N)%nat -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;zero &lt; a -&gt; zero &lt; b -&gt; c = cons a   k b <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; pred_spec c.<br/>

<br/>

<br/>

<br/>

<br/>
<span class="keyword">Definition</span> <a name="Pred"></a>Pred : pred_spec c.<br/>

<br/>

<br/>
<span class="keyword">End</span> predecessor.<br/>

<br/>
<span class="keyword">Definition</span> <a name="gpred"></a>gpred : forall (N0:nat)(c:T1), correct (S (S N0)) c -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;nf c -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;pred_spec N0 c.<br/>

<br/>

<br/>
<span class="keyword">Lemma</span> <a name="gpred_lt"></a>gpred_lt : <br/>
&nbsp;forall (N0 : nat) (c : T1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(H:correct (S (S N0)) c)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(H': nf c), <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;match (gpred N0 c H H')<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with (exist c' _) =&gt; c = zero /\ c'=zero  \/ c' &lt; c end.<br/>

<br/>
<span class="keyword">Definition</span> <a name="goodstein_next"></a>goodstein_next N0 c (H:nf c)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(H0 : correct (S (S N0)) c) :<br/>
&nbsp;&nbsp;&nbsp;{c' : T1 | nf c' /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;correct (S (S (S N0))) c' /\ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(c=zero /\ c'=zero \/ c' &lt; c) /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;val (S (S (S N0))) c' = <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Peano.pred (val (S (S (S N0))) c)}.<br/>

<br/>
<span class="keyword">Definition</span> <a name="goodstein_next_ord"></a>goodstein_next_ord  N0 c (H:nf c)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(H0 : correct (S (S N0)) c) : T1.<br/>

<br/>
<span class="keyword">Lemma</span> <a name="goodstein_next_ord_lt"></a>goodstein_next_ord_lt : forall N0 c (H:nf c)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(H0 : correct (S (S N0)) c),<br/>
&nbsp;&nbsp;&nbsp;(c = zero /\  <br/>
&nbsp;&nbsp;&nbsp;&nbsp;goodstein_next_ord N0 c H H0 = zero)  \/ <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;goodstein_next_ord N0 c H H0 &lt; c.<br/>

<br/>
<span class="keyword">Lemma</span> <a name="goodstein_next_ord_nf"></a>goodstein_next_ord_nf : forall N0 c (H:nf c)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(H0 : correct (S (S N0)) c),<br/>
&nbsp;&nbsp;&nbsp;nf (goodstein_next_ord N0 c H H0).<br/>

<br/>
<span class="keyword">Lemma</span> <a name="goodstein_next_ord_correct"></a>goodstein_next_ord_correct : forall N0 c (H:nf c)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(H0 : correct (S (S N0)) c),<br/>
&nbsp;&nbsp;&nbsp;correct (S (S (S N0))) (goodstein_next_ord N0 c H H0).<br/>

<br/>
<span class="keyword">Inductive</span> <a name="Rg"></a>Rg : (prod nat T1) -&gt; (prod nat T1) -&gt; Prop :=<br/>
&nbsp;&nbsp;<a name="Rg_i"></a>Rg_i : forall N0 c (H: nf c)(H0: (correct   (S (S N0)) c)),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Rg (N0,c)  (S N0, goodstein_next_ord N0 c H H0).<br/>
<span class="keyword">Notation</span>  "i1 '-G-&gt;' i2" := (Rg i1 i2) (at level 70): cantor_scope.<br/>

<br/>
<span class="keyword">Require</span> <span class="keyword">Import</span> Relations.<br/>
<span class="keyword">Notation</span> "i1 '-G-&gt;*' i2" := (clos_refl_trans _ Rg i1 i2) (at level 70):cantor_scope.<br/>

<br/>
<span class="keyword">Lemma</span> <a name="Goodstein_decrease"></a>Goodstein_decrease : forall N0 c N' c', (N0,c) -G-&gt; (N',c') -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;c = zero /\ c'=zero \/ c' &lt; c.<br/>

<br/>
<span class="keyword">Theorem</span> <a name="Goodstein_thm"></a>Goodstein_thm : forall c , nf c -&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;forall N0, correct (S (S N0)) c -&gt; {N':nat |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(N0,c) -G-&gt;* (N',zero)}.<br/>

<br/>

<br/>

<br/>

<br/>

<br/>

<br/>
</code>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/><font size="-1">This page has been generated by <a href="http://coq.inria.fr">coqdoc</a></font>
</div>

</div>

</body>
</html>